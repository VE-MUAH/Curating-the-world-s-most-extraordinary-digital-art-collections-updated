{% extends 'app/base.html' %}

{% block content %}
<div class="collection-hero">
  <!-- Use collection cover as background if available -->
  <img src="{{ collection.collcover }}" class="collection-hero-bg" alt="Background">
  <div class="container collection-hero-content">
    <h1 class="collection-title">{{ collection.collection_name }}</h1>
    <p class="collection-desc">{{ collection.description }}</p>
  </div>
</div>

<div class="container mb-5">
  <div class="items-header text-center mb-4">
    <h3 class="font-weight-light">Gallery Pieces</h3>
    <hr class="w-10">
  </div>

  <div class="row">
    {% for pieceobj in collection.piece_set.all %}
    <div class="col-md-6 col-lg-4 mb-4">
      <div class="card collection-card h-100">
        <img src="{{pieceobj.piececover}}" class="card-img-top" alt="{{pieceobj.title}}" style="height: 300px;">
        <div class="card-body">
          <h5 class="card-title">{{pieceobj.title}}</h5>
          <div class="artist-info d-flex align-items-center mb-2">
            {% if pieceobj.artist_photo %}
            <img src="{{pieceobj.artist_photo}}" alt="{{pieceobj.artist}}" class="artist-avatar me-2"
              style="width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid #6c63ff;">
            {% endif %}
            <p class="card-text mb-0"><strong>Artist:</strong> {{pieceobj.artist}}</p>
          </div>
          <p class="card-text"><strong>Type:</strong> {{pieceobj.type}}</p>
          <p class="card-text"><small class="text-muted">Year: {{pieceobj.year}}</small></p>

          {% if user.is_authenticated %}
          <div class="mt-3 border-top pt-2 text-right">
            <a href="{% url 'edit_piece' pieceobj.id %}" class="btn btn-sm btn-outline-primary">Edit</a>
            <a href="{% url 'delete_piece' pieceobj.id %}" class="btn btn-sm btn-outline-danger">Delete</a>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
    {% empty %}
    <div class="col-12 text-center">
      <p>No pieces found in this collection yet.</p>
    </div>
    {% endfor %}
  </div>

  <div class="text-center mt-4">
    <a href="{% url 'index' %}" class="btn btn-outline-dark">‚Üê Back to Collections</a>
  </div>
</div>
{% endblock %}